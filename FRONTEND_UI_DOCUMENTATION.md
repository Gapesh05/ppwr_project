# ğŸ–¥ï¸ Frontend UI Documentation - PFAS/PPWR Application

## ğŸ“„ PAGE 1: Dashboard (`/`)

### Purpose
Main landing page showing all products grouped by SKU with their assessment routes and upload timestamps.

### UI Layout

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  PFAS/PPWR Dashboard                                    [User: Admin] [âš™ï¸]  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                            â•‘
â•‘  ğŸ“Š Products Overview                                  [â• Upload BOM]     â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ SKU: VET-SYRINGE-001                        Route: PPWR     [â–¶ Start]â”‚ â•‘
â•‘  â”‚ Product: Veterinary Syringe Assembly                                 â”‚ â•‘
â•‘  â”‚ ğŸ“… Uploaded: 2026-01-25 14:32 UTC                                    â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Materials: 12  |  Declarations: 8/12  |  Status: âš ï¸ In Progress      â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ SKU: PACK-BOX-5530                          Route: PFAS     [â–¶ Start]â”‚ â•‘
â•‘  â”‚ Product: Corrugated Packaging Box 5530                               â”‚ â•‘
â•‘  â”‚ ğŸ“… Uploaded: 2026-01-24 09:15 UTC                                    â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Materials: 5   |  Declarations: 5/5   |  Status: âœ… Complete         â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ SKU: LAB-TUBE-A7658                         Route: PPWR     [â–¶ Start]â”‚ â•‘
â•‘  â”‚ Product: Laboratory Sample Tube                                      â”‚ â•‘
â•‘  â”‚ ğŸ“… Uploaded: 2026-01-23 16:48 UTC                                    â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Materials: 8   |  Declarations: 3/8   |  Status: ğŸ”´ Missing Files    â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                            â•‘
â•‘  [1] [2] [3] ... [10]                           Showing 1-3 of 28 productsâ•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Key Features
- **Upload Timestamp Display:** Shows when each product BOM was uploaded (from `ppwr_bom.uploaded_at`)
- **Route Badge:** Displays whether product uses PFAS or PPWR assessment
- **Progress Tracking:** Shows how many declarations uploaded vs total materials
- **Status Indicators:**
  - âœ… Complete: All materials have declarations
  - âš ï¸ In Progress: Some declarations missing
  - ğŸ”´ Missing Files: Many declarations missing
- **Quick Actions:** "Start" button routes to appropriate assessment page

### Data Source
```sql
SELECT DISTINCT 
    ppwr_bom.sku,
    route.route,
    MAX(ppwr_bom.uploaded_at) as uploaded_at
FROM ppwr_bom
LEFT JOIN route ON ppwr_bom.sku = route.sku
GROUP BY ppwr_bom.sku, route.route
ORDER BY uploaded_at DESC;
```

---

## ğŸ“„ PAGE 2: PPWR Assessment Tab (`/assessment/<sku>?tab=ppwr`)

### Purpose
Manage supplier declarations for a specific product's materials. Upload PDFs, map declarations to materials, view evaluation.

### UI Layout

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Assessment: VET-SYRINGE-001                             [â† Back to Home]  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â•‘
â•‘  â”‚  PFAS   â”‚  PPWR*  â”‚  RoHS   â”‚  REACH  â”‚  Other  â”‚                     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â•‘
â•‘                                                                            â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  ğŸ”µ PPWR Tab - Packaging & Packaging Waste Regulation                     â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                            â•‘
â•‘  ğŸ“ Supplier Declarations                        [ğŸ” View Evaluation]     â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘
â•‘                                                                            â•‘
â•‘  Quick Actions:  [â˜‘ï¸ Select All] [ğŸ“¤ Upload Selected] [ğŸ—‘ï¸ Archive]        â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ â˜  Material      Declaration File       Size    Upload Time  Actionsâ”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  A7658         ğŸ“„ A7658_PETG.pdf      2.3 MB  Jan 25 14:32  [â–¼]  â”‚  â•‘
â•‘  â”‚                                                                      â”‚  â•‘
â•‘  â”‚    âœ Supplier Campaign: Active                                      â”‚  â•‘
â•‘  â”‚    âœ Supplier Name: PlasticTech Inc.                                â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  A8362         ğŸ“„ A8362_Tyvek.pdf     1.8 MB  Jan 25 14:31  [â–¼]  â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  B7346         ğŸ“„ B7346_PE.pdf        1.5 MB  Jan 25 14:30  [â–¼]  â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  B7462         âŒ Missing Declaration                      [ğŸ“¤]   â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  C7236         ğŸ“„ C7236_PP_Film.pdf   2.1 MB  Jan 25 14:28  [â–¼]  â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â˜  C9347         âŒ Missing Declaration                      [ğŸ“¤]   â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                            â•‘
â•‘  ğŸ“‹ Material â†’ Declaration Mapping                                        â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ BOM Material     Declaration File           Mapped    Last Updated  â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ A7658            A7658_PETG.pdf             âœ…        Jan 25 14:32  â”‚  â•‘
â•‘  â”‚ A8362            A8362_Tyvek.pdf            âœ…        Jan 25 14:31  â”‚  â•‘
â•‘  â”‚ B7346            B7346_PE.pdf               âœ…        Jan 25 14:30  â”‚  â•‘
â•‘  â”‚ B7462            âš ï¸ Not Mapped              âŒ        â€”             â”‚  â•‘
â•‘  â”‚ C7236            C7236_PP_Film.pdf          âœ…        Jan 25 14:28  â”‚  â•‘
â•‘  â”‚ C9347            âš ï¸ Not Mapped              âŒ        â€”             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                            â•‘
â•‘  Upload Progress: 4/6 materials (66.7%)                                   â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Key Features

#### Supplier Declarations Table
- **Session-based Checkbox Selection:** â˜‘ï¸ Select All with indeterminate state
- **Cleaner Actions Column:** Only shows expansion toggle [â–¼]
- **Row Expansion:** Click [â–¼] to reveal inline details:
  - Supplier Campaign status (Active/Inactive)
  - Supplier Name (from `ppwr_bom.supplier_name`)
- **Upload Time Display:** Shows when declaration was uploaded (from `supplier_declaration_v1.upload_date`)
- **Missing Indicators:** âŒ for materials without declarations with [ğŸ“¤] upload button
- **Quick Actions Bar:**
  - Select All checkbox
  - Upload Selected button (batch upload for checked rows)
  - Archive button (soft-delete checked declarations)

#### Material â†’ Declaration Mapping Table
- **BOM Material:** From `ppwr_bom.material_id`
- **Declaration File:** From `supplier_declaration_v1.original_filename`
- **Mapped Status:** âœ… if linked via `ppwr_material_declaration_link`, âŒ if not
- **Last Updated:** From `ppwr_material_declaration_link.created_at`

#### Upload Progress Bar
- Shows fraction of materials with declarations
- Visual progress indicator

### Data Source
```sql
-- Supplier Declarations
SELECT 
    sd.id,
    sd.material_id,
    sd.original_filename,
    sd.file_size,
    sd.upload_date,
    pb.supplier_name
FROM supplier_declaration_v1 sd
LEFT JOIN ppwr_bom pb ON sd.material_id = pb.material_id
WHERE pb.sku = 'VET-SYRINGE-001';

-- Material Mapping Status
SELECT 
    pb.material_id,
    sd.original_filename,
    CASE WHEN pmdl.id IS NOT NULL THEN true ELSE false END as is_mapped,
    pmdl.created_at
FROM ppwr_bom pb
LEFT JOIN ppwr_material_declaration_link pmdl ON pb.material_id = pmdl.material_id
LEFT JOIN supplier_declaration_v1 sd ON pmdl.decl_material_v1 = sd.id
WHERE pb.sku = 'VET-SYRINGE-001';
```

---

## ğŸ“„ PAGE 3: Evaluation Page (`/ppwr/evaluation?sku=VET-SYRINGE-001`)

### Purpose
Display PPWR assessment results with component-level chemical composition and compliance status.

### UI Layout

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  PPWR Evaluation Summary - VET-SYRINGE-001              [â† Back] [ğŸ“¥ Export]â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                            â•‘
â•‘  ğŸ“Š Assessment Statistics                                                  â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘  â”‚ Total Files â”‚ Downloaded  â”‚ Conformance â”‚ Non-Conformance     â”‚       â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â•‘
â•‘  â”‚     12      â”‚    8 (67%)  â”‚   6 (75%)   â”‚   2 (25%)          â”‚       â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                                            â•‘
â•‘  ğŸ§ª Chemical Composition Analysis                                         â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘
â•‘                                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Component  â”‚ Subcomp. â”‚ Material â”‚ Supplier       â”‚ CAS ID      â”‚... â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ Syringe    â”‚ Barrel   â”‚ A7658    â”‚ PlasticTech    â”‚ 24938-67-8  â”‚... â”‚ â•‘
â•‘  â”‚ Body       â”‚          â”‚ (PETG)   â”‚ Inc.           â”‚             â”‚    â”‚ â•‘
â•‘  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Chemical: Polyethylene Terephthalate Glycol (PETG)                  â”‚ â•‘
â•‘  â”‚ Concentration: 145.50 ppm                                            â”‚ â•‘
â•‘  â”‚ Status: âœ… Compliant                                                 â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ Packaging  â”‚ Outer    â”‚ A8362    â”‚ DuPont         â”‚ 25038-59-9  â”‚... â”‚ â•‘
â•‘  â”‚            â”‚ Wrap     â”‚ (Tyvek)  â”‚ Tyvek Div.     â”‚             â”‚    â”‚ â•‘
â•‘  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Chemical: High-Density Polyethylene (HDPE)                          â”‚ â•‘
â•‘  â”‚ Concentration: 89.25 ppm                                             â”‚ â•‘
â•‘  â”‚ Status: âœ… Compliant                                                 â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ Plunger    â”‚ Tip      â”‚ B7346    â”‚ RubberSeal     â”‚ 9002-88-4   â”‚... â”‚ â•‘
â•‘  â”‚            â”‚          â”‚ (PE)     â”‚ Co.            â”‚             â”‚    â”‚ â•‘
â•‘  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Chemical: Polyethylene (PE)                                          â”‚ â•‘
â•‘  â”‚ Concentration: 220.75 ppm                                            â”‚ â•‘
â•‘  â”‚ Status: ğŸ”´ Non-Compliant (Exceeds 200 ppm threshold)                â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ Box        â”‚ Primary  â”‚ B7462    â”‚ âš ï¸ Missing     â”‚ â€”           â”‚... â”‚ â•‘
â•‘  â”‚            â”‚          â”‚ (Board)  â”‚ Declaration    â”‚             â”‚    â”‚ â•‘
â•‘  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Chemical: Unknown                                                    â”‚ â•‘
â•‘  â”‚ Concentration: â€”                                                     â”‚ â•‘
â•‘  â”‚ Status: âš ï¸ Awaiting Declaration                                     â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ Label      â”‚ Adhesive â”‚ C7236    â”‚ AdhesiveTech   â”‚ 9003-07-0   â”‚... â”‚ â•‘
â•‘  â”‚            â”‚          â”‚ (PP)     â”‚ Solutions      â”‚             â”‚    â”‚ â•‘
â•‘  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â•‘
â•‘  â”‚ Chemical: Polypropylene Film                                         â”‚ â•‘
â•‘  â”‚ Concentration: 135.00 ppm                                            â”‚ â•‘
â•‘  â”‚ Status: âœ… Compliant                                                 â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                            â•‘
â•‘  [1] [2] [3]                                    Showing 1-5 of 12 materialsâ•‘
â•‘                                                                            â•‘
â•‘  Legend:                                                                  â•‘
â•‘  âœ… Compliant: Meets PPWR requirements                                    â•‘
â•‘  ğŸ”´ Non-Compliant: Exceeds regulatory thresholds                         â•‘
â•‘  âš ï¸ Awaiting Declaration: No supplier data received                      â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Key Features

#### Statistics Cards
- **Total Files:** Count of distinct materials in BOM (`ppwr_bom`)
- **Downloaded:** Count of materials with chemical data (`ppwr_result`)
- **Conformance:** Count of materials with status containing "compliant"
- **Non-Conformance:** Count of materials with status containing "non-compliant"

#### Chemical Composition Table
- **Component/Subcomponent:** From `ppwr_bom.component_description` and `subcomponent_description`
- **Material:** From `ppwr_bom.material_id` and `material_name`
- **Supplier:** From `ppwr_result.supplier_name`
- **CAS ID:** From `ppwr_result.cas_id`
- **Chemical:** From `ppwr_result.chemical`
- **Concentration:** From `ppwr_result.concentration` (formatted as "145.50 ppm")
- **Status:** From `ppwr_result.status` with color coding:
  - âœ… Green for "Compliant"
  - ğŸ”´ Red for "Non-Compliant"
  - âš ï¸ Yellow for "Unknown" or missing data

#### SKU Filtering
- URL parameter: `/ppwr/evaluation?sku=VET-SYRINGE-001`
- Filter applied in SQL query before rendering
- Shows only materials for specified SKU

#### Export Function
- [ğŸ“¥ Export] button generates Excel file with all evaluation data
- Includes all columns with color-coded status cells
- Filename format: `PPWR_Evaluation_{SKU}_{timestamp}.xlsx`

### Data Source
```sql
SELECT 
    pb.component,
    pb.component_description,
    pb.subcomponent,
    pb.subcomponent_description,
    pb.material_id,
    pb.material_name,
    pr.supplier_name,
    pr.cas_id,
    pr.chemical,
    pr.concentration,
    pr.status
FROM ppwr_bom pb
LEFT JOIN ppwr_result pr ON pb.material_id = pr.material_id
WHERE pb.sku = 'VET-SYRINGE-001'
ORDER BY pb.component, pb.subcomponent, pb.material_id;
```

---

## ğŸ¨ Design Notes

### Color Scheme
- **Primary Blue:** `#0d6efd` - Action buttons, links
- **Success Green:** `#198754` - Compliant status, checkmarks
- **Danger Red:** `#dc3545` - Non-compliant status, errors
- **Warning Yellow:** `#ffc107` - Missing data, in-progress
- **Light Gray:** `#f8f9fa` - Table backgrounds, secondary elements

### Responsive Behavior
- **Desktop (>1200px):** Full layout as shown in mockups
- **Tablet (768px-1200px):** Stacked cards, simplified tables
- **Mobile (<768px):** Single column layout, touch-optimized buttons

### Accessibility
- **ARIA Labels:** All interactive elements labeled
- **Keyboard Navigation:** Full tab/enter support
- **Screen Reader:** Table headers properly associated
- **Color Contrast:** WCAG AA compliant (4.5:1 minimum)

### Loading States
- **Skeleton Screens:** For initial page loads
- **Spinners:** For AJAX operations (declaration upload)
- **Progress Bars:** For batch operations (multi-file upload)
- **Toast Notifications:** For success/error messages

---

## ğŸ”— Navigation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard   â”‚
â”‚      /       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“ [Start Button]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PPWR Assessment Tab        â”‚
â”‚   /assessment/<sku>?tab=ppwr â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“ [View Evaluation]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Evaluation Page          â”‚
â”‚   /ppwr/evaluation?sku=... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### URL Parameters
- Dashboard: No params required
- Assessment: `<sku>` in path, `?tab=ppwr` in query
- Evaluation: `?sku=<value>` in query (optional, shows all if omitted)

---

## ğŸ“± User Workflows

### Workflow 1: New Product Upload
1. **Dashboard:** Click [â• Upload BOM]
2. **Upload Modal:** Select Excel file, choose route (PFAS/PPWR)
3. **Dashboard:** Product appears with timestamp and "Missing Files" status
4. **Assessment Tab:** Click [â–¶ Start] to manage declarations

### Workflow 2: Upload Supplier Declarations
1. **Assessment Tab:** Click [ğŸ“¤] next to missing material
2. **Upload Modal:** Select PDF file
3. **Assessment Tab:** Declaration appears with upload timestamp
4. **Automatic Mapping:** System links declaration to material via `material_id`

### Workflow 3: View Evaluation
1. **Assessment Tab:** Click [ğŸ” View Evaluation]
2. **Evaluation Page:** Review component-level chemical data
3. **Evaluation Page:** Check compliance status for each material
4. **Evaluation Page:** Click [ğŸ“¥ Export] to download Excel report

### Workflow 4: Bulk Operations
1. **Assessment Tab:** Check multiple materials
2. **Assessment Tab:** Click [â˜‘ï¸ Select All] to select all visible
3. **Quick Actions:** Click [ğŸ“¤ Upload Selected] or [ğŸ—‘ï¸ Archive]
4. **Batch Processing:** System processes all checked items

---

## ğŸ› Error Handling

### Missing Data Indicators
- **âŒ Missing Declaration:** Red X icon with [ğŸ“¤] upload button
- **âš ï¸ Not Mapped:** Yellow warning with auto-map suggestion
- **ğŸ”´ Non-Compliant:** Red status badge with threshold details
- **â€”** (em dash): Used for null/empty fields

### Error Messages
- **Upload Failed:** "Failed to upload declaration for material {id}. Please check file format."
- **Mapping Failed:** "Could not map declaration to material. BOM entry may be missing."
- **Query Failed:** "Failed to load evaluation data. Please contact administrator."

### Fallback Behavior
- **Empty Dashboard:** Show "No products uploaded yet" message with [â• Upload BOM] CTA
- **Empty Assessment:** Show "No materials found for this SKU" with back button
- **Empty Evaluation:** Show "No chemical data available. Upload declarations to continue."

---

## âœ¨ Implemented Features

- âœ… Dashboard with upload timestamps (`ppwr_bom.uploaded_at`)
- âœ… PPWR tab with session-based checkbox selection
- âœ… Cleaner Actions column (expansion toggle only)
- âœ… Row expansion showing supplier campaign and name
- âœ… Evaluation page querying `ppwr_result` + `ppwr_bom`
- âœ… SKU filtering in evaluation page
- âœ… Component/subcomponent columns displayed
- âœ… Upload time display for declarations
- âœ… Mapping status indicators
- âœ… Compliance status color coding

---

## ğŸ“ Technical Notes

### Frontend Framework
- **Flask 3.x** with Jinja2 templates
- **Bootstrap 5.3** for responsive layout
- **jQuery 3.x** for AJAX and DOM manipulation
- **DataTables** for sortable/filterable tables

### Backend API
- **FastAPI 0.109** for backend services
- **PostgreSQL 13+** for data storage
- **SQLAlchemy 2.x** for ORM

### File Storage
- **Supplier Declarations:** Stored as `BYTEA` in `supplier_declaration_v1.file_data`
- **Maximum File Size:** 10 MB per PDF
- **Allowed Formats:** PDF, DOCX, XLSX

### Performance
- **Pagination:** 10 items per page default
- **Lazy Loading:** Declaration file bytes loaded on-demand
- **Caching:** Material counts cached for 5 minutes
- **Indexing:** All foreign keys indexed for fast JOINs
